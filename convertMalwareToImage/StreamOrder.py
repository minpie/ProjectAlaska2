from PIL import Image
import sys
import math
import os


# Messages:
MSG_Usage = """
Usage:

"""


# 변수 / 객체 / etc :
inputFileName = "" # 이미지화 대상 파일
outputFileName = "" # 저장할 이미지 파일
inputFileObject = None # 이미지화 대상 파일 객체
outputImageObject = None # 저장할 이미지에 해당하는 객체
imageWidth = 0 # 이미지 폭
imageHeight = 0 # 이미지 높이
inputFileSize = 0 # 입력파일 크기
currentBytes = 0 # 현재 읽고 있는 데이터
countBytes = 0 # 작업중인 픽셀 카운터


# Main code:
if(len(sys.argv) == 1):
    print(MSG_Usage)
    sys.exit()
# 

inputFileName = sys.argv[1]
outputFileName = sys.argv[2]



# 파일 크기 측정하여 이미지 폭/높이 계산:
inputFileSize = os.path.getsize(inputFileName) # 파일 크기 측정
imageWidth = int(math.sqrt(inputFileSize)) + 1 # 폭: 파일 크기의 제곱근
imageHeight = imageWidth # 높이: 파일 크기의 제곱근


# 이미지 객체 생성:
outputImageObject = Image.new(mode="L", size=(imageWidth, imageHeight)) # 파일 객체 생성

# 입력 파일 작업:
inputFileObject = open(inputFileName, "rb") # byte 모드로 열기



for i in range(inputFileSize):
    currentBytes = ord(inputFileObject.read(1)) # 1바이트 읽어 int로 변환
    # 현재 위치 계산:
    curX = (countBytes % imageWidth) # x좌표
    curY = int(countBytes / imageHeight) # y좌표
    
    # 픽셀 지정:
    outputImageObject.putpixel((curX, curY), currentBytes) # 한 픽셀 지정
    countBytes += 1 # 위치 카운터 증가



# 이미지로 저장:

outputImageObject.save(outputFileName) # 이미지로 저장
# End