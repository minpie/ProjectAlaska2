'''
파일들에 대한 작업을 지속적으로 수행하는 코드 원형.
대상 폴더를 지정하고 실행하면, 해당 폴더 내의
모든 파일에 대해서 아래 함수를 실행함.
해당 폴더에 파일이 추가되면 그 또한 반영되어 실행함.
'''
# Imports:
import os
import sys


# 변수 / 객체 / etc:
currentFileList = [] #
previusFileList = [] #
outputDirectoryPath = "/storages/hdd0/pt0/ProjectAlaska2Datas/Datasets/output_images/StreamOrder/" # 출력이미지 파일 저장할 폴더 경로
inputDirectoryPath = "/storages/hdd0/pt0/ProjectAlaska2Datas/Datasets/track_a_learn/learn/" # 입력파일 저장된 폴더 경로
currentDirectoryPath = "/storages/hdd0/pt0/ProjectAlaska2Datas/Datasets/track_a_learn/learn/"
visualizeAppPath = "/storages/hdd0/pt0/ProjectAlaska2/convertMalwareToImage/StreamOrder.py" # 실행할 파일 경로


# Main Function:
def FuncVisualize(fileName):
    commandRunVisualize = "python3 " + visualizeAppPath + " " + inputDirectoryPath + fileName + " " + outputDirectoryPath + fileName + ".png"
    print(commandRunVisualize)
    os.system(commandRunVisualize)
    pass

def FuncStart(fileName):
    FuncVisualize(fileName) # 이미지화
    pass


# Messages:
MSG_Standalone = """
Usage:

"""
#
#if __name__ == "__main__":
#    print(MSG_Standalone)
#    sys.exit()

# Main code:
#currentDirectoryPath = os.path.abspath(__file__) # 현재 path 얻기


while True:
    try:
        currentFileList = os.listdir(currentDirectoryPath)
        if(currentFileList != previusFileList):
            differenceList = list(set(currentFileList) - set(previusFileList))
            for newFile in differenceList:
                FuncStart(newFile)
            pass
            previusFileList = currentFileList
        pass
    except KeyboardInterrupt:
        print("Break!")
        break
print("End!")
sys.exit()


# End